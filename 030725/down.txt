SELECT callcenter_calldetail.campaign_name as campaign_name , usr.username as user , CONCAT(usr.first_name, ' ' ,usr.last_name) as full_name , callcenter_calldetail.phonebook as phonebook , callcenter_calldetail.customer_cid as customer_cid , callcenter_calldetail.contact_id as contact_id , callcenter_calldetail.uniqueid as lan , callcenter_calldetail.session_uuid as session_uuid , date_trunc('second', COALESCE(callcenter_diallereventlog.init_time, callcenter_calldetail.init_time) at time zone 'Asia/Kolkata') as init_time , date_trunc('second', COALESCE(callcenter_diallereventlog.ring_time, callcenter_calldetail.ring_time) at time zone 'Asia/Kolkata') as ring_time , date_trunc('second', COALESCE(callcenter_diallereventlog.connect_time, callcenter_calldetail.connect_time) at time zone 'Asia/Kolkata') as connect_time , date_trunc('second', COALESCE(callcenter_diallereventlog.hangup_time, callcenter_calldetail.hangup_time) at time zone 'Asia/Kolkata') as hangup_time , COALESCE(callcenter_diallereventlog.wait_time, callcenter_calldetail.wait_time) as wait_time , COALESCE(callcenter_diallereventlog.ring_duration, callcenter_calldetail.ring_duration) as ring_duration , COALESCE(callcenter_diallereventlog.hold_time, callcenter_calldetail.hold_time) as hold_time , callcenter_calldetail.callflow as callflow , callcenter_calldetail.callmode as callmode , COALESCE(callcenter_diallereventlog.bill_sec, callcenter_calldetail.bill_sec) as talk_time , COALESCE(callcenter_diallereventlog.ivr_duration, callcenter_calldetail.ivr_duration) as ivr_duration , COALESCE(callcenter_diallereventlog.call_duration, callcenter_calldetail.call_duration) as call_duration , callcenter_calldetail.feedback_time as wrapup_time , cast(COALESCE(callcenter_diallereventlog.call_duration, callcenter_calldetail.call_duration)::interval + feedback_time::interval as text) as call_length , callcenter_calldetail.hangup_source as hangup_source , callcenter_calldetail.internal_tc_number as internal_tc_number , callcenter_calldetail.external_tc_number as external_tc_number , callcenter_calldetail.progressive_time as progressive_time , callcenter_calldetail.preview_time as preview_time , callcenter_calldetail.predictive_wait_time as predictive_wait_time , callcenter_calldetail.inbound_wait_time as inbound_wait_time , callcenter_calldetail.blended_wait_time as blended_wait_time , COALESCE(callcenter_diallereventlog.hangup_cause, callcenter_calldetail.hangup_cause) as hangup_cause , COALESCE(callcenter_diallereventlog.hangup_cause_code, callcenter_calldetail.hangup_cause_code) as hangup_cause_code , COALESCE(callcenter_diallereventlog.dialed_status, callcenter_calldetail.dialed_status) as dialed_status , callcenter_cdrfeedbck.primary_dispo as primary_dispo , callcenter_cdrfeedbck.feedback ->> 'wset_amount' as "wset_amount" , callcenter_cdrfeedbck.feedback ->> 'paid_in_branch' as "paid_in_branch" , callcenter_cdrfeedbck.feedback ->> 'ptp/pu_date' as "ptp/pu_date" , callcenter_cdrfeedbck.feedback ->> 'paid_in_cash_to_agent' as "paid_in_cash_to_agent" , callcenter_cdrfeedbck.feedback ->> 'ptp_date' as "ptp_date" , callcenter_cdrfeedbck.feedback ->> 'action_code' as "action_code" , callcenter_cdrfeedbck.feedback ->> 'pu_amount' as "pu_amount" , callcenter_cdrfeedbck.feedback ->> 'follow_up' as "follow_up" , callcenter_cdrfeedbck.feedback ->> 'rfd' as "rfd" , callcenter_cdrfeedbck.feedback ->> 'paid_onlin' as "paid_onlin" , callcenter_cdrfeedbck.feedback ->> 'ptp_amount' as "ptp_amount" , callcenter_cdrfeedbck.feedback ->> 'on_or_before_ptp_date' as "on_or_before_ptp_date" , callcenter_cdrfeedbck.feedback ->> 'next_action_code' as "next_action_code" , callcenter_cdrfeedbck.feedback ->> 'pu_date' as "pu_date" , callcenter_cdrfeedbck.feedback ->> 'amount' as "amount" , callcenter_cdrfeedbck.feedback ->> 'next_action_date_time' as "next_action_date_time" , COALESCE(sms.name, 'No') as sms_sent , sms.name as sms_message , callcenter_cdrfeedbck.comment as comment from callcenter_calldetail left join callcenter_diallereventlog on callcenter_diallereventlog.session_uuid = callcenter_calldetail.session_uuid left join callcenter_cdrfeedbck on callcenter_cdrfeedbck.calldetail_id=callcenter_calldetail.id left join callcenter_user usr on usr.id = callcenter_calldetail.user_id left join callcenter_user supr on supr.id = usr.reporting_to_id left join (select sms.session_uuid as session_uuid, string_agg(template.name, ', ') as name from callcenter_smslog sms left join callcenter_smstemplate template on sms.template_id = template.id left join callcenter_calldetail calldetail on calldetail.session_uuid = sms.session_uuid where calldetail.campaign_name IN ('test_login', 'ManualCallBack', 'Secured_South', 'South_Recovery', 'Telugu', 'WEST_CAT_C', 'SOUTH_CAT_A', 'SOUTH_CAT_C', 'SOUTH_ENACH', 'WEST_ENACH', 'Tamil_PR_Test', 'Mumbai', 'South_Secured', 'Malyalam') group by sms.session_uuid) sms on sms.session_uuid = callcenter_calldetail.session_uuid WHERE ( callcenter_calldetail.created at time zone 'Asia/Kolkata' between '2025-07-02T00:00:00' and '2025-07-02T12:45:00') and ((callcenter_calldetail.campaign_name IN ('test_login', 'ManualCallBack', 'Secured_South', 'South_Recovery', 'Telugu', 'WEST_CAT_C', 'SOUTH_CAT_A', 'SOUTH_CAT_C', 'SOUTH_ENACH', 'WEST_ENACH', 'Tamil_PR_Test', 'Mumbai', 'South_Secured', 'Malyalam') AND COALESCE(callcenter_calldetail.user_id, 0) IN (579, 578, 577, 576, 575, 571, 569, 568, 567, 566, 564, 563, 561, 560, 559, 558, 557, 556, 554, 553, 552, 551, 549, 548, 547, 543, 542, 541, 538, 537, 536, 535, 534, 533, 532, 531, 530, 529, 528, 527, 526, 525, 523, 522, 520, 519, 518, 517, 516, 515, 514, 513, 508, 507, 506, 505, 503, 502, 501, 500, 499, 497, 496, 495, 494, 489, 488, 487, 486, 482, 481, 480, 478, 477, 476, 474, 473, 472, 470, 469, 466, 465, 464, 461, 459, 456, 455, 454, 453, 452, 450, 449, 448, 445, 441, 440, 439, 438, 437, 433, 432, 431, 428, 427, 425, 424, 423, 416, 415, 413, 407, 405, 404, 403, 402, 401, 398, 397, 396, 395, 391, 389, 387, 386, 385, 384, 383, 381, 378, 374, 373, 372, 371, 370, 369, 368, 362, 361, 360, 359, 358, 356, 355, 354, 353, 352, 351, 350, 348, 347, 344, 343, 341, 340, 339, 338, 335, 333, 332, 330, 322, 308, 306, 305, 304, 302, 299, 296, 295, 293, 291, 289, 287, 284, 283, 275, 265, 251, 239, 236, 233, 228, 226, 201, 184, 182, 171, 152, 150, 149, 147, 136, 129, 124, 118, 117, 116, 109, 108, 106, 102, 97, 94, 93, 91, 88, 86, 83, 79, 77, 76, 75, 74, 73, 71, 67, 61, 60, 56, 55, 53, 52, 51, 50, 48, 46, 42, 35, 33, 31, 30, 29, 28, 26, 23, 21, 20, 19, 17, 16, 14, 12))) order by callcenter_calldetail.created desc
